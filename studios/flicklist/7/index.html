<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Studio: FlickList 7 :: Unit 2: Web Fundamentals</title>

        <link rel="stylesheet" href="http://education.launchcode.org/web-fundamentals/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://education.launchcode.org/web-fundamentals/css/highlight.launchcode.css">
        <link rel="stylesheet" href="http://education.launchcode.org/web-fundamentals/css/main.css">
        <link rel="stylesheet" href="https://djwbyvgln9kts.cloudfront.net/launch_ed_style/custom.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <ul class="nav navbar-nav">

                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle glyphicon glyphicon-menu-hamburger" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"></a>
                        <ul class="dropdown-menu">
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/classes/">
                                        Classes
                                    </a>
                                </li>
                                                            <li class="active lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/studios/">
                                        Studios
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/tutorials/">
                                        Tutorials
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/assignments/">
                                        Assignments
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/videos/">
                                        Videos
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/cheatsheets/">
                                        Cheatsheets
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/objectives/">
                                        Objectives
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/issues/">
                                        Issues
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="http://education.launchcode.org/web-fundamentals/about/">
                                        About this Unit
                                    </a>
                                </li>
                                                        <li role="separator" class="divider"></li>
                            <li>
                                <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                            </li>
                        </ul>
                    </li>

                
            </ul>

            <div>
                <a class="navbar-brand site-title navbar-center" href="http://education.launchcode.org/web-fundamentals/">
                    <h1>Unit 2: Web Fundamentals</h1>
                </a>
            </div>

            <div class="nav navbar-nav navbar-right">
                <a class="navbar-brand dabomb" href="http://education.launchcode.org/web-fundamentals/"></a>
            </div>

        </header>

        <!-- Search Modal -->
        <div id="modalSearch" class="modal fade" role="dialog">
           <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal">&times;</button>
                   <h4 class="modal-title">Search Unit 2: Web Fundamentals</h4>
                </div>
                <div class="modal-body">
                    <script>
                      (function() {
                        var cx = "014657181352409571810:wecoswt6tpe";
                        var gcse = document.createElement('script');
                        gcse.type = 'text/javascript';
                        gcse.async = true;
                        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                        var s = document.getElementsByTagName('script')[0];
                        s.parentNode.insertBefore(gcse, s);
                      })();
                    </script>
                    <gcse:search></gcse:search>
                </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

           </div>
        </div>

        <main class="container-fluid">
            <div class="row">

                <section id="content" class="col-sm-offset-2 col-sm-8">
                                        <h1>Studio: FlickList 7</h1>
                    <p>Today we'll add <em>Users</em> to our application, and allow them to log in,
log out, and create accounts. We'll learn how to store state in a
user's session.  We'll learn about <em>flash messages</em>, which let us
overlay messages onto the next page the user visits.</p>
<p>You are encouraged to code along, which, as usual, you can do by
checking out the <code>walkthrough7</code> branch:</p>
<pre><code class="language-nohighlight">$ git checkout walkthrough7
Branch walkthrough7 set up to track remote branch walkthrough7 from origin.
Switched to a new branch 'walkthrough7'</code></pre>
<h2 id="walkthrough">Walkthrough</h2>
<p>Thus far, our web-app does not have a concept of user accounts built
in. As a result, there is only one &quot;communal&quot; movie list, and all the
users who visit our site work &quot;collaboratively&quot; on that list. That's
kind of cool maybe, but our goal is a site where each user manages her
own list, without interference from other users. </p>
<p>The goal today, at a high level, is to implement the existence of user
accounts and registration, and ensure that users cannot see the main
pages of the site unless they are logged in.</p>
<p>More specifically, we will update our codebase with the following
additions:</p>
<ul>
<li>A <code>User</code> class to represent and save users in our database.</li>
<li>New routes and methods: <code>register</code> and <code>logout</code>.</li>
<li>A new template for the <code>register</code> page.</li>
<li>We'll modify our <code>base</code> template to display the username or links to login and register.</li>
<li>A 'login wall' that monitors requests of unlogged-in users, and prompts them to create an account if they're not logged in.</li>
<li>We'll further modify our <code>base</code> template to display flash messages, so that we can tell the user things like &quot;you typed the wrong password&quot;</li>
</ul>
<aside class="aside-note">
<p>For simplicity's sake, today we will just drop and re-create the database. In a later lesson, we will discuss migrations which is how to transform database schema without destroying the existing data.</p>
</aside>
<h2 id="studio">Studio</h2>
<p>You know how annoying it is to create new accounts on websites? It
always seems like the name you want is taken, or the passowords must
have 87 digits in them, or whatever? Congratulations, now you get to
make those rules yourself.</p>
<p>Also, right now the only way to log is is as a side-effect of creating
a new account. It'd be neat if once users created accounts and logged
out, they could log back in using their existing email and password.</p>
<h3 id="checking-out-the-studio-code">Checking out the Studio code</h3>
<p>Follow the [instructions for getting the code][get-the-code] in order to get the starter code for <code>studio7</code>.</p>
<h3 id="before-you-begin-create-the-user-db-table-locally">Before you begin: create the 'user' DB table locally</h3>
<pre><code class="language-nohighlight">(flicklist) $ python
&gt;&gt;&gt; from main import db, User
...
&gt;&gt;&gt; db.create_all()
...
&gt;&gt;&gt; db.session.commit()
User.query.all()
...
[]
</code></pre>
<h3 id="your-tasks">Your Tasks</h3>
<ol>
<li>When a user tries to create an account, but supplies different 'password' and 'verify' fields, redirect them back to '/register' and flash them a message about why thier attempt to create an account failed. </li>
<li>Log out, and see what happens when you try to create a user that already exists. This happens because we passed the 'unique=True' keyword param to the User.email db.Column invocation. When we wear our DB Admin hats, we're happy to get this error, but when we wear our UX designer hats, we want something friendlier. Before creating an account, search the database for an existing account with that email. If it exists already, redirect them back to 'register' and tell them why their account creation failed. </li>
<li>Add a new route for '/login', that responds to GET and renders a 'login.html' template.</li>
<li>Create the 'login.html' template, with form fields for email and password.</li>
<li>Test out your new route - one problem you will notice is that you get redirected to the 'register.html' page. Change the login wall to allow this route through.</li>
</ol>
<h3 id="retrospective">Retrospective</h3>
<p>We've created users and managed the login and logout process. But the
User model doesn't relate at all to our Movie model. In the next
studio, we'll 'cross the streams' and store movies on a per-user basis.</p>
                                    </section>

            </div>
        </main>

        <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="http://education.launchcode.org/web-fundamentals/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://education.launchcode.org/web-fundamentals/js/highlight.pack.js"></script>
        <script type="text/javascript" src="http://education.launchcode.org/web-fundamentals/js/libgif.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');

                // Syntax highlighting
                hljs.configure({ displayLabels: true });
                hljs.initHighlightingOnLoad();
            });
        </script>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', "UA-78748330-3", 'auto');
            ga('send', 'pageview');

        </script>

    </body>
</html>
